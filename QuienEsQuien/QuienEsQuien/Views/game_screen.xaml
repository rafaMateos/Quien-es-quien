<Page Name="Principal"
      
    x:Class="QuienEsQuien.Views.game_screen"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:QuienEsQuien.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:vm="using:QuienEsQuien.Viewmodel"
    Background="#536DFE"
    xmlns:ConverterCarta="using:QuienEsQuien.Converters"
    >

    <Page.DataContext>
        <vm:viewModel/>
    </Page.DataContext>

   
    <Page.Resources>
        <ConverterCarta:converterEstadoCarta x:Key="conversorEstadoCarta"></ConverterCarta:converterEstadoCarta>
    </Page.Resources>

    <RelativePanel Padding="10" Margin="10">

        <StackPanel Name="botoneraSuperior" Orientation="Horizontal"
                    RelativePanel.AlignTopWithPanel="True"
                    RelativePanel.AlignLeftWithPanel="True"
                    Padding="5">

            <Button Click="Btn_Salir_Click" Name="btn_Salir" Content="Salir"
                        Background="Green" Margin="0,0,5,0"/>

            <ComboBox  ItemsSource="{Binding Path=listadoSecundarioDeCartas, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}" 
                           PlaceholderText="¿Eres ... ?"
                           Width="250" Margin="50,0,5,0">

                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal" ScrollViewer.VerticalScrollMode="Enabled">
                            <Image Source="{Binding Path=imagenUri}" 
                                       Height="25" Width="25" Stretch="UniformToFill" 
                                       HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                            <TextBlock Text="{Binding Path=nombreCarta}" VerticalAlignment="Center" Padding="10,0,0,0"/>
                        </StackPanel>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <Button Content="Confirmar seleccion" Background="#D32F2F" 
                    Foreground="White" Margin="0,0,5,0"/>

            <Button Click="Btn_Pasar_Click" Name="btn_Pasar" Content="Pasar turno"
                        Background="Yellow" Margin="50,0,5,0"/>
        </StackPanel>

        <GridView Name="gridImagenes"
                  RelativePanel.Below="botoneraSuperior"
                  RelativePanel.AlignLeftWithPanel="True"
                  RelativePanel.AlignBottomWithPanel="True"
                  RelativePanel.LeftOf="contenedorChat"
                ItemsSource="{Binding listadoDeCartas}"
                SelectedItem="{Binding cartaSeleccionada, Mode=TwoWay}" 
                  Background="White">
            <GridView.ItemTemplate>
                <DataTemplate x:Name="cartitaTemplate" >
                    <StackPanel x:Name="cartaSelectPanel" 
                                    Height="200" Width="150" Margin="12"  
                                    Opacity="{Binding Path=estaBajada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter = {StaticResource conversorEstadoCarta}}"
                                    >
                        <Image Source="{Binding Path=imagenUri}" 
                                   Height="165" Width="165" Stretch="UniformToFill" 
                                   HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                        <StackPanel>
                            <TextBlock Text="{Binding Path=nombreCarta}"/>
                            <TextBlock Text="{Binding Path=esGanadora}"/>
                        </StackPanel>
                    </StackPanel>
                </DataTemplate>
            </GridView.ItemTemplate>

            <GridView.ItemsPanel>
                <ItemsPanelTemplate>
                    <ItemsWrapGrid MaximumRowsOrColumns="6" Orientation="Horizontal"/>
                </ItemsPanelTemplate>
            </GridView.ItemsPanel>
        </GridView>

        <RelativePanel Name="Cargando" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Center" Background="White" Width="500" Height="500">

            <TextBlock  Text="Uniendote a sala.." FontSize="50" RelativePanel.AlignHorizontalCenterWithPanel="True" RelativePanel.AlignVerticalCenterWithPanel="True">

            </TextBlock>
        </RelativePanel>

        <!--<RelativePanel Name="contenedorTuyo" 
                       Background="Aquamarine" Margin="5,0,0,5" Padding="5"
                       RelativePanel.AlignRightWithPanel="True"
                       RelativePanel.AlignLeftWith="contenedorChat">
            <TextBlock Name="tuPersonajeNombre" Text="Tu eres:"  
                       HorizontalAlignment="Center"
                       RelativePanel.AlignLeftWithPanel="True"/>
            <Image Name="tuPersonajeImagen" Source="../Assets/QS_Rafa.jpg" 
                       MaxHeight="130" HorizontalAlignment="Right"
                       RelativePanel.Below="tuPersonajeNombre"
                       RelativePanel.AlignRightWithPanel="True"/>
            <TextBlock Name="turno" Text="xXxXxXxX"  
                           HorizontalAlignment="Center"
                       RelativePanel.Below="tuPersonajeImagen"/>
        </RelativePanel>-->

        <RelativePanel Name="contenedorChat" 
                       Background="Aquamarine"
                       RelativePanel.AlignRightWithPanel="True"
                       RelativePanel.AlignBottomWithPanel="True"
                       RelativePanel.AlignTopWithPanel="True"
                       Width="330"
                       Margin="5,0,0,0" >

            <RelativePanel Name="contenedorTuyo" 
                       Background="Aquamarine" Margin="5,0,0,5" Padding="5"
                       RelativePanel.AlignBottomWithPanel="False"
                           HorizontalAlignment="Left">
                <TextBlock Name="tuPersonajeNombre" Text="Tu eres:"
                       RelativePanel.AlignLeftWithPanel="True"/>
                <Image Name="tuPersonajeImagen" Source="../Assets/QS_Rafa.jpg" 
                       MaxHeight="130" HorizontalAlignment="Right"
                       RelativePanel.Below="tuPersonajeNombre"
                       RelativePanel.AlignRightWithPanel="True"/>
                <TextBlock Name="turno" Text="xXxXxXxX"  
                       HorizontalAlignment="Center"
                       RelativePanel.Below="tuPersonajeImagen"/>
            </RelativePanel>

            <ListView Name="contanierChat" Background="Brown" 
                       RelativePanel.AlignLeftWithPanel="True"
                       RelativePanel.AlignRightWithPanel="True"
                       RelativePanel.Above="contenedorSend"
                      RelativePanel.Below="contenedorTuyo"
                       ItemsSource="{Binding msgsChats,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"> 
                <ListView.ItemTemplate> 
                    <DataTemplate > 
                        <StackPanel Orientation="Horizontal"> 
                            <TextBlock Text="{Binding Path=nickName}"></TextBlock>
                            <TextBlock Text="{Binding Path=message,Mode=TwoWay}"></TextBlock> 
                        </StackPanel> 
                    </DataTemplate> 
                </ListView.ItemTemplate> 
            </ListView>


            <RelativePanel Name="contenedorSend" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignRightWithPanel="True" RelativePanel.AlignLeftWithPanel="True">

                <TextBox KeyDown="Tbx_chat_KeyDown" Name="tbx_chat"
                        RelativePanel.LeftOf="btn_send"
                        RelativePanel.AlignLeftWithPanel="True"
                         />

                <Button Click="Btn_send_Click" Name="btn_send" 
                            Content="Send" RelativePanel.AlignRightWithPanel="True"
                            Background="Purple"/>
            </RelativePanel>


        </RelativePanel>

    </RelativePanel>

</Page>
