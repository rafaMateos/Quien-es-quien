<Page Name="Principal"
      
    x:Class="QuienEsQuien.Views.game_screen"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:QuienEsQuien.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:vm="using:QuienEsQuien.Viewmodel"
    Background="#536DFE"
    xmlns:ConverterCarta="using:QuienEsQuien.Converters"
    >

    <Page.DataContext>
        <vm:viewModel/>
    </Page.DataContext>

   
    <Page.Resources>
        <ConverterCarta:converterEstadoCarta x:Key="conversorEstadoCarta"></ConverterCarta:converterEstadoCarta>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="5*" MinWidth="620"></ColumnDefinition>
            <ColumnDefinition Width="2*"  MinWidth="230"></ColumnDefinition>
        </Grid.ColumnDefinitions>

        <Grid Grid.Row="0" Grid.Column="0" Background="White" Margin="10">
            <GridView 
                ItemsSource="{Binding listadoDeCartas}"
                SelectedItem="{Binding cartaSeleccionada, Mode=TwoWay}">
                <GridView.ItemTemplate>
                    <DataTemplate x:Name="cartitaTemplate">
                        <StackPanel x:Name="cartaSelectPanel" 
                                    Height="200" Width="150" Margin="12"  
                                    Opacity="{Binding Path=estaBajada, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Converter = {StaticResource conversorEstadoCarta}}">
                            <Image Source="{Binding Path=imagenUri}" 
                                   Height="165" Width="165" Stretch="UniformToFill" 
                                   HorizontalAlignment="Stretch" VerticalAlignment="Stretch"/>
                            <StackPanel>
                                <TextBlock Text="{Binding Path=nombreCarta}"/>
                                <TextBlock Text="{Binding Path=esGanadora}"/>
                            </StackPanel>
                        </StackPanel>
                    </DataTemplate>
                </GridView.ItemTemplate>

                <GridView.ItemsPanel>
                    <ItemsPanelTemplate>
                        <ItemsWrapGrid MaximumRowsOrColumns="6" Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </GridView.ItemsPanel>
            </GridView>

        </Grid>

        <RelativePanel Name="Cargando" Visibility="Collapsed" HorizontalAlignment="Center" VerticalAlignment="Center" Background="White" Width="500" Height="500">

            <TextBlock  Text="Uniendote a sala.." FontSize="50" RelativePanel.AlignHorizontalCenterWithPanel="True" RelativePanel.AlignVerticalCenterWithPanel="True">
                
            </TextBlock>
        </RelativePanel>

        <Grid Grid.Column="1" MinWidth="200" Background="White" Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"></RowDefinition>
                <RowDefinition Height="3*"></RowDefinition>
            </Grid.RowDefinitions>

            <Grid.ColumnDefinitions>
                <ColumnDefinition></ColumnDefinition>
            </Grid.ColumnDefinitions>

            <RelativePanel Name="contenedorTuyo" Background="Aquamarine" Margin="5" Grid.Column="0" Grid.Row="0" Padding="5">
                <TextBlock Name="tuPersonajeNombre" Text="Tu eres:"  
                           HorizontalAlignment="Center"
                       RelativePanel.AlignRightWithPanel="True"/>
                <Image Name="tuPersonajeImagen" Source="../Assets/QS_Rafa.jpg" 
                       MaxHeight="130" HorizontalAlignment="Right"
                       RelativePanel.Below="tuPersonajeNombre"
                       RelativePanel.AlignRightWithPanel="True"/>
                <TextBlock Name="turno" Text="xXxXxXxX"  
                           HorizontalAlignment="Center"
                       RelativePanel.Below="tuPersonajeImagen"/>
            </RelativePanel>

            <RelativePanel Name="contenedorChat" Background="Aquamarine" Margin="5" Grid.Column="0" Grid.Row="1"  Padding="5">

                <ListView Name="contanierChat" Background="Brown" 
                       RelativePanel.AlignLeftWithPanel="True"
                       RelativePanel.AlignRightWithPanel="True"
                       RelativePanel.AlignTopWithPanel="True"
                       RelativePanel.Above="contenedorSend"
                       ItemsSource="{Binding msgsChats,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}">

                    <ListView.ItemTemplate>

                        <DataTemplate >

                            <StackPanel Orientation="Horizontal">

                                <TextBlock Text="{Binding Path=nickName}"></TextBlock>
                                <TextBlock Text="{Binding Path=message,Mode=TwoWay}"></TextBlock>

                            </StackPanel>

                        </DataTemplate>


                    </ListView.ItemTemplate>


                </ListView>


                <RelativePanel Name="contenedorSend" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignRightWithPanel="True" RelativePanel.AlignLeftWithPanel="True">

                    <Button Click="Btn_Salir_Click" Name="btn_Salir" Content="SALIR"
                        RelativePanel.AlignLeftWithPanel="True"
                        Background="Green"/>

                    <Button Click="Btn_Pasar_Click" Name="btn_Pasar" Content="Pasar"
                        RelativePanel.RightOf="btn_Salir"
                        Background="Yellow"/>

                    <TextBox KeyDown="Tbx_chat_KeyDown" Name="tbx_chat"
                        RelativePanel.LeftOf="btn_send"
                        RelativePanel.RightOf="btn_Pasar"
                         />

                    <Button Click="Btn_send_Click" Name="btn_send" 
                            Content="Send" RelativePanel.AlignRightWithPanel="True"
                            Background="Purple"/>
                </RelativePanel>


            </RelativePanel>

        </Grid>
    </Grid>
</Page>
